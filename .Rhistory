m <- addTiles(m)
#m <- addProviderTiles(m, provider = "Esri.WorldImagery")
station_ids = strsplit(temp, "./")
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
print(dateSubSums)
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = (dateSubSums$x[dateSubSums$station_id==i] / 1000))
}
m
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_size(dateSubSums$x[dateSubSums$station_id==i]))
}
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
marker_radius <- function(num_rides) {
print(num_rides)
print(typeof(num_rides))
radius = 0
if (num_rides < 1000){
radius = 20
}
else if (num_rides < 2000){
radius = 40
}
else if (num_rides < 2500){
radius = 60
}
else if(num_rides < 4000){
radius = 80
}
else{
radius = 100
}
return (radius)
}
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
source("~/Desktop/CS 424/Project2-CTAMap/scrap.r", echo=TRUE)
print(dateSubSums)
print(dateSubSums$x[dateSubSums$station_id==40200])
DateSub <- subset(ridership_data, newDate == "2021-08-23")
dateSubSums <- aggregate(DateSub$rides, by=list(station_id=DateSub$station_id), FUN=sum)
head(dateSubSums)
print(dateSubSums)
print(temp)
#read in the list of stops and latitudes and longitudes
stopData <- read.csv(file = 'StopList.csv')
print(head(stopData))
print(stopData)
print(stopData$location[stopData$MAP_ID==40200])
#read in the list of stops and latitudes and longitudes
stopData <- read.csv(file = 'StopList.csv')
print(head(stopData))
print(stopData$location[stopData$MAP_ID==40200])
print(stopData$Location[stopData$MAP_ID==40200])
head(dateSubSums)
print(dateSubSums$x[dateSubSums$station_id==40050])
print(stopData$Location[stopData$MAP_ID==40050])
#read in the list of stops and latitudes and longitudes
stopData <- read.csv(file = 'StopList.csv')
print(head(stopData))
DateSub <- subset(ridership_data, newDate == "2021-08-23")
dateSubSums <- aggregate(DateSub$rides, by=list(station_id=DateSub$station_id), FUN=sum)
m <- leaflet()
m <- addTiles(m)
#m <- addProviderTiles(m, provider = "Esri.WorldImagery")
station_ids = strsplit(temp, "./")
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
dateSubSums$x[dateSubSums$station_id==i]
print(temp)
print(dateSubSums$x[dateSubSums$station_id==40200])
DateSub <- subset(ridership_data, newDate == "2021-08-23")
dateSubSums <- aggregate(DateSub$rides, by=list(station_id=DateSub$station_id), FUN=sum)
print(dateSubSums)
print(temp)
library(shiny)
library(ggplot2)
library(shinydashboard)
library(lubridate)
library(jpeg)
library(grid)
library(leaflet)
library(scales)
library(dplyr)
library(plyr)
library(readr)
library(leaflet)
library(leaflet.providers)
#read in the data for stations
temp = list.files(pattern="*.csv", full.name = T)
print(temp)
temp = temp[-148] #delete the last file to be read separately
#read in the files
ridership_data = ldply(temp, read_csv)
print(head(ridership_data))
#read in the list of stops and latitudes and longitudes
stopData <- read.csv(file = 'StopList.csv')
print(stopData)
#fix dates using lubridate
ridership_data$newDate = as_date(mdy(ridership_data$date))
#add day, month and year data to csv
ridership_data$year = year(ridership_data$newDate)
ridership_data$month = month(ridership_data$newDate, abbr = TRUE, label = TRUE)
ridership_data$wday = weekdays(as.POSIXct(ridership_data$newDate), abbreviate = T)
#changes rides from character to numeric
ridership_data$rides <- as.numeric(gsub(",","",ridership_data$rides))
print(head(ridership_data))
print(stopData)
print(stopData$Location[stopData$MAP_ID==40050])
DateSub <- subset(ridership_data, newDate == "2021-08-23")
dateSubSums <- aggregate(DateSub$rides, by=list(station_id=DateSub$station_id), FUN=sum)
m <- leaflet()
m <- addTiles(m)
#m <- addProviderTiles(m, provider = "Esri.WorldImagery")
station_ids = strsplit(temp, "./")
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
marker_radius <- function(num_rides) {
print(num_rides)
print(typeof(num_rides))
radius = 0
if (num_rides < 1000){
radius = 20
}
else if (num_rides < 2000){
radius = 40
}
else if (num_rides < 2500){
radius = 60
}
else if(num_rides < 4000){
radius = 80
}
else{
radius = 100
}
return (radius)
}
for (i in station_ids){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
dateSubSums$x[dateSubSums$station_id==i]
m
print(station_ids)
print(dateSubSums)
print(if(dateSubSums$x[dateSubSums$station_id==40200]>0))
if(dateSubSums$x[dateSubSums$station_id==40200]>0){
print(1)
}
runApp()
print(DateSub$x[DateSub$station_id==40200])
for (i in nrow(dateSubSums)){
i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == i)
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
print(dateSubSums)
for (i in 45){
print(i)
}
for (i in 1:45){
print(i)
}
#i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == dateSubSums[i, "x"])
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
a <- subset(stopData, MAP_ID == dateSubSums[i, "x"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "x"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
print(a)
print(string)
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
print(a)
string <- a$Location[1]
print(string)
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums$x[dateSubSums$station_id==i]))
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
print(a)
string <- a$Location[1]
print(string)
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
dateSubSums$x[dateSubSums$station_id==i]
m
print(i)
for (i in 1:nrow(dateSubSums)){
print(i)
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
print(a)
string <- a$Location[1]
print(string)
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
dateSubSums$x[dateSubSums$station_id==i]
m
marker_radius <- function(num_rides) {
print(num_rides)
print(typeof(num_rides))
radius = 0
if (num_rides < 1000){
radius = 2
}
else if (num_rides < 2000){
radius = 4
}
else if (num_rides < 2500){
radius = 6
}
else if(num_rides < 4000){
radius = 8
}
else{
radius = 10
}
return (radius)
}
for (i in 1:nrow(dateSubSums)){
print(i)
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
print(a)
string <- a$Location[1]
print(string)
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
dateSubSums$x[dateSubSums$station_id==i]
m
radius = 0
marker_radius <- function(num_rides) {
radius = 0
if (num_rides < 1000){
radius = 2
}
else if (num_rides < 2000){
radius = 4
}
else if (num_rides < 2500){
radius = 6
}
else if(num_rides < 4000){
radius = 8
}
else{
radius = 10
}
return (radius)
}
for (i in 1:nrow(dateSubSums)){
print(i)
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
print(a)
string <- a$Location[1]
print(string)
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
m
for (i in 1:nrow(dateSubSums)){
print(i)
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "station_id"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(dateSubSums[i, "x"])
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
marker_radius <- function(num_rides) {
radius = 0
if (num_rides < 1000.0){
radius = 2
}
else if (num_rides < 2000.0){
radius = 4
}
else if (num_rides < 2500.0){
radius = 6
}
else if(num_rides < 4000.0){
radius = 8
}
else{
radius = 10
}
return (radius)
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
m
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]/1000))
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]/1000))
}
m
m <- leaflet()
m <- addTiles(m)
#m <- addProviderTiles(m, provider = "Esri.WorldImagery")
station_ids = strsplit(temp, "./")
print(station_ids)
for (i in 1:45){
print(i)
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]/1000))
}
m
m <- leaflet()
m <- addTiles(m)
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
m
marker_radius <- function(num_rides) {
radius = 0
if (num_rides < 1000.0){
radius = 4
}
else if (num_rides < 2000.0){
radius = 6
}
else if (num_rides < 2500.0){
radius = 8
}
else if(num_rides < 4000.0){
radius = 10
}
else{
radius = 10
}
return (radius)
}
marker_radius <- function(num_rides) {
radius = 0
if (num_rides < 1000.0){
radius = 4
}
else if (num_rides < 2000.0){
radius = 6
}
else if (num_rides < 2500.0){
radius = 8
}
else if(num_rides < 4000.0){
radius = 10
}
else{
radius = 12
}
return (radius)
}
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
m
m <- leaflet()
m <- addTiles(m)
for (i in 1:nrow(dateSubSums)){
#i = strsplit(i[2], ".csv")
print(typeof(dateSubSums[i, "x"]))
a <- subset(stopData, MAP_ID == dateSubSums[i, "station_id"])
string <- a$Location[1]
mat = matrix(scan(text = gsub("[()]", "", string), sep = ","),
ncol = 2, byrow = TRUE, dimnames = list(NULL, c("Lat", "Long")))
m <- addCircleMarkers(m, lng=mat[1,2], lat=mat[1,1], popup=a$STOP_NAME[1], radius = marker_radius(dateSubSums[i, "x"]))
}
m
runApp()
runApp()
